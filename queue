#include<stdio.h>
#include<stdlib.h>
struct Queue
{
    int front;
    int rear;
    int *q;
}Q;
int size;
void insrear()
{
    int ele;
    printf("\nEnter the value to be inserted ");
    scanf("%d",&ele);
    if(Q.front==0&&Q.rear==size-1||Q.front>Q.rear)
    {
        printf("\nEmpty queue.Reallocating memory");
        size++;
        Q.q=(int*)realloc(Q.q,size*sizeof(int));
    }
     if(Q.front==-1)
     {
        Q.front=0;
        Q.rear=0;
     }
     else if(Q.rear==size-1)
       {
          Q.rear=0;
       }
    else
       Q.rear++;

    *(Q.q+Q.rear)=ele;
}
void display()
{
    printf("\n");
    if(Q.front==-1)
    {
        printf("Empty list");
        return;
    }
    if(Q.front<=Q.rear)
    {
        for(int i=Q.front;i<=Q.rear;i++)
        {
            printf("%d\t",*(Q.q+i));
        }
    }
    else
    {
        for(int i=Q.front;i<=size-1;i++)
        {
            printf("%d\t",*(Q.q+i));
        }
        for(int i=0;i<=Q.rear;i++)
        {
            printf("%d\t",*(Q.q+i));
        }

    }
}
void insfront()
{
    int ele;
    printf("\nEnter the value to be inserted ");
    scanf("%d",&ele);
    if(Q.front==0&&Q.rear==size||Q.front>Q.rear)
    {
        printf("Memory full.");
    }
    if(Q.front==-1)
     {
        Q.front=0;
        Q.rear=0;
     }
     else if(Q.front==0)
             {
              Q.front=size-1;
             }
           else
           {
            Q.front--;
           }
     *(Q.q+Q.front)=ele;

}
void delrear()
{
    if(Q.front==-1)
    {
        printf("\nEmpty queue");
        return;
    }
    printf("%d is deleted ",*(Q.q+Q.rear));

    if(Q.front==Q.rear)
    {
        Q.front=-1;
        Q.rear=-1;
    }
    else if(Q.rear==0)
    {
        Q.rear=size-1;
    }
    else
    Q.rear--;
}
void delfront()
{
    if(Q.front==-1)
    {
        printf("\nEmpty queue");
        return;
    }
    printf("%d is deleted ",*(Q.q+Q.front));

    if(Q.front==Q.rear)
    {
        Q.front=-1;
        Q.rear=-1;
    }
    else if(Q.front==size-1)
    {
        Q.front=0;
    }
    else
    Q.front++;
}
void main()
{
    int ch;
    printf("Enter the size of th queue ");
    scanf("%d",&size);
    Q.front=-1;
    Q.rear=-1;
    printf("\nMain menu\n1.Insert front\n2.Insert rear\n3.Delete front\n4.Delete rear\n5.Display\n6.exit");
    Q.q=(int*)malloc(size*sizeof(int));
    for(;;)
    {
        printf("\nEnter your choice");
        scanf("%d",&ch);
        switch(ch)
        {
            case 1:
            insfront();
            display();
            break;
            case 2:
            insrear();
            display();
            break;
            case 3:
            delfront();
            display();
            break;
            case 4:
            delrear();
            display();
            break;
            case 5:
            display();
            break;
            case 6:
            exit(0);
            default:
            printf("Invalied choice");
            break;
        }
    }
}
